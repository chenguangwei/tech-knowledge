# 架构图设计及工具简谈

[TOC]

## 一、架构图简介

### 1、架构图的定义及作用

#### 什么是架构图

什么是架构图？维基百科、百度百科其实都没有关于它的直接定义。不过我们可以进行拆分理解：

- **架构图=架构+图**

这样问题就转化成，什么是架构，以及什么是图？

关于架构，百度百科上是这样定义的：

> 架构，又名软件架构，是有关软件整体结构与组件的抽象描述，于指导型软件系统各个方面的设计。

也就是说，**架构是由系统组件，以及组件间相互关系共同构成的集合体**。

而架构图，则是用来表达这种集合的载体。

它的作用也很简单，两个：

- **划分目标系统边界**
- **将目标系统的结构可视化**

进而减少沟通障碍，提升协作效率。

#### 怎样的架构图是好的架构图

在画出一个好的架构图之前， 首先应该要明确其受众，再想清楚要给他们传递什么信息 ，所以，不要为了画一个物理视图去画物理视图，为了画一个逻辑视图去画逻辑视图，而应该根据受众的不同，传递的信息的不同，用图准确地表达出来，最后的图可能就是在这样一些分类里。那么，画出的图好不好的一个直接标准就是：受众有没有准确接收到想传递的信息。

## 二、架构方法及画法

1、现在常见的分层架构方法，4类：业务架构、应用架构、数据架构和技术架构，

2、UML分类方法：是4+1视图，分别为场景视图、逻辑视图、物理视图、处理流程视图和开发视图

### 分层分类：

#### 业务架构

![img](https://pic2.zhimg.com/80/v2-8d21ed1aa6a87760311e6cb5e8cc986a_1440w.jpg?source=1940ef5c)

#### 应用架构

![img](https://pic1.zhimg.com/80/v2-46f5907b0b9a6b79888d8b2cd3a480f0_1440w.jpg?source=1940ef5c)

应用架构图分为两类，一类为多系统应用架构，用来分层次说明不同系统间的业务逻辑关系、信息流、系统边界等等。一类为单系统应用架构，用来分层次说明系统主要组成模块和功能点之间的业务逻辑关系。

| 架构图类型 | 适用岗位 | 定位                                                                        |
| ----- | ---- | ------------------------------------------------------------------------- |
| 业务架构图 | 产品经理 | ①帮助产品经理基于对企业业务系统生态有全局掌握的情况下参与制定业务决策。 ②帮助产品经理梳理新增系统在企业应用生态中的定位以及和其他系统之间的关系 |
| 技术架构图 | 技术人员 | 帮助技术人员搭建良好的技术规范和编码大纲                                                      |

一般而言，由于现互联网公司产品经理越来越聚焦于功能设计和业务决策，而技术人员则越来越聚焦于技术设计。所以对于产品经理而言，架构图的运用则侧重在业务架构图上，技术架构图则由技术经理负责。当然产品经理如果也有技术背景，有能力理解技术架构图则更好

![img](https://upload-images.jianshu.io/upload_images/421898-6904ab4c761a48d0.png?imageMogr2/auto-orient/strip|imageView2/2/w/587/format/webp)

#### 业务架构图

业务架构图可以按多系统业务架构图和单系统业务架构图进行说明。

##### 多系统业务架构图

![img](https:////upload-images.jianshu.io/upload_images/421898-94c504d0ffd9ea96.png?imageMogr2/auto-orient/strip|imageView2/2/w/648/format/webp)

来源于《深度｜从一个故事说起，谈谈企业应用架构的演变史》，作者杨堃，侵删)

由上图可见，业务架构图是从业务逻辑的视角出发，为产品经理整齐地展现出一个企业各类系统之间的层次和关系

使用多系统应用架构图还有一个好处在于，每当有新增的子系统时，可以提前预判是否需要共用哪些单元或者业务逻辑

##### 单系统业务架构图

对于一个从0到1的项目而言，产品经理除了要了解这个项目在整个企业应用架构中的定位，还要对整个系统的模块和功能有着清晰的分层次设计和了解。所以产品经理就不仅需要多系统业务架构图，也需要单系统业务架构图。

![img](https://upload-images.jianshu.io/upload_images/421898-1059b93ae02e076d.png?imageMogr2/auto-orient/strip|imageView2/2/w/595/format/webp)

由上图可以看出，单系统应用架构图分层可以和多系统应用架构图一致。但是每个层次里面的说明单元就变成功能模块，而非子系统。

#### 数据架构

![img](https://pic2.zhimg.com/80/v2-a45c9757e5c21b0f5e1220aa454dd8c9_1440w.jpg?source=1940ef5c)

#### 技术架构

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/0602796178fe4560a58f68da898aa478?from=pc)

### UML分类

标准化建模语言。UML用于帮助系统开发人员阐明，展示，构建和记录软件系统的产出

UML 的主要目的，如下：

1. 为用户提供现成的、有表现力的可视化建模语言，以便他们开发和交换有意义的模型。
2. 为核心概念提供可扩展性 (Extensibility) 和特殊化 (Specialization) 机制。
3. 独立于特定的编程语言和开发过程。
4. 为了解建模语言提供一个正式的基础。
5. 鼓励面向对象工具市场的发展。
6. 支持更高层次的开发概念，如协作，框架，模式和组件。
7. 整合最佳的工作方法 (Best Practices)。

常用部分UML图如下

#### 场景视图

场景视图用于描述系统的参与者与功能用例间的关系，反映系统的最终需求和交互设计，通常由用例图表示。

![img](https://pica.zhimg.com/80/v2-dec763e007ca46e7a02be2e469d8dc9a_1440w.jpg?source=1940ef5c)

#### 逻辑视图

逻辑视图用于描述系统软件功能拆解后的组件关系，组件约束和边界，反映系统整体组成与系统如何构建的过程，通常由UML的组件图和类图来表示。

![img](https://pic1.zhimg.com/80/v2-330f2df73d0b4a9018c5b33a9dfe9a68_1440w.jpg?source=1940ef5c)

#### 物理视图

物理视图用于描述系统软件到物理硬件的映射关系，反映出系统的组件是如何部署到一组可计算机器节点上，用于指导软件系统的部署实施过程

![img](https://pic2.zhimg.com/80/v2-ff3d1fd920059df0bb24e2ce439ea24d_1440w.jpg?source=1940ef5c)

#### 处理流程视图

处理流程视图用于描述系统软件组件之间的通信时序，数据的输入输出，反映系统的功能流程与数据流程,通常由时序图和流程图表示

![img](https://pic2.zhimg.com/80/v2-95366c6b02ef7d7cb2535ef3aa2b0e1c_1440w.jpg?source=1940ef5c)

#### 开发视图

开发视图用于描述系统的模块划分和组成，以及细化到内部包的组成设计，服务于开发人员，反映系统开发实施过程。

![img](https://pic3.zhimg.com/80/v2-830e8cb3070eb7eced89f2153a64255f_1440w.jpg?source=1940ef5c)

## 三、软件架构设计

### 1.架构思维概述

对于架构思维本身仍然是类似系统思维，结构化思维，编程思维等诸多思维模式的一个合集。由于架构的核心作用是在业务现实世界和抽象的IT实现之间建立起一道桥梁，因此架构思维最核心的就是要理解到业务驱动技术，技术为最终的业务服务。要真正通过架构设计来完成业务和技术，需求和实现，软件和硬件，静态和动态，成本和收益等多方面的平衡。

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/889d53790da54353bc0be4ab472f581a?from=pc)

架构设计中有两个重点，一个是分解，一个是集成。

分解是最基础的，架构的重点就是要对复杂问题进行分而治之，同时保证分解后的各个部分还能够高内聚，松耦合，最终又集成为一个完整的整体。分解核心是定义问题，因此架构首先仍然需要理解清楚需求。

集成是配合分解完成的动作，最终分解完成的各个组件或子系统，通过合适的接口设计，最终还能够集成为一个完整的整体，分解仅仅是加速开发和降低问题复杂度，如果分解后的内容无法集成在一起，那么分解就没有任何意义。

分解+集成可以理解为架构最核心的思考方式和方法

在分解完成后，一个大的系统已经拆分为了诸多的小模块，或者一个小模块实现本身又分为了多个步骤阶段。那么零散的节点必须向上汇集和归纳，形成一个完整的架构。

这个架构的形成就是要有分层思维，架构分层是谈架构绝对绕不开的一个点，通过架构分层可以更好地全面理解业务系统或功能实现。

## 四、如何画架构图

按照分层思维，架构图的分层构图逻辑常见如下

### 架构图的分层构图逻辑

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/b84a69beabb545fcb5585748e7631353?from=pc)

不同类型的架构图的核心分层逻辑，可以看到在画架构图的时候尽量不要混合使用不同场景下的构图方式，否则就导致整体架构图混乱

同时一个完整的架构本身就是多视角的，如下：

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/abff0805fb0a4973a9d31a749e98834f?from=pc)

功能架构往往可以给具体用户和业务人员看，而对于技术架构往往更多是内部团队开发人员研讨使用。而设计到资源和平台的架构图往往又是运维工程人员进行部署架构搭建的重要参考。因此不同维度的架构分层属性本身不能随意融合使用，而导致架构图混乱。

要完成一个完整的架构图构图，可以先拆分为两边+中间。两边一般是放具体的标准，规范等，比如安全管理，质量管理，技术标准规范，开发运维规范等。

中间即是重点需要考虑进行分层构建的地方。

中间部分重点参考云计算和SOA的架构分层逻辑。一般来说核心的还是资源层，平台层，应用层，门户层。而对于应用层本身又可以考虑业务域进一步拆分，或者根据价值链或业务生命周期拆分为多个阶段域再展开描述，还需要分清是构建技术架构图还是功能架构图，两者本身的分层逻辑也存在很大的差别而不能混用

常用的分层方式有：云平台分层、SOA架构分层、应用技术架构、应用功能架构、部署架构、中台架构分层等多个分层方法

#### 云平台分层

云平台的分层逻辑，即标准的 IaaS-PaaS-SaaS 三层

- IaaS 层：资源层，计算，存储，网络
- PaaS 层：各种平台可以放到这层，包括技术平台，集成平台，数据平台等
- SaaS 层：对应到应用即服务

当然在构图的时候往往会进一步做些扩展。

比如构建物联网应用的架构，一般会在底层扩展网络和感知层。如果要体现平台 + 应用的服务化开发思路，一般会增加一个独立的服务层或能力开放层。

云计算架构分层模型一般用在最顶层的整体架构规划设计，这类架构图重点体现出云架构分层，体现平台 + 应用化构建，体现出各个应用域和具体应用。

要明白在这类架构图里面，各个应用一般只会是一个小方框而不会展开。但是从整个大架构规划里面又能够看到基于云平台构建了哪些具体的应用。

比如一个智慧城市标准平台和应用的架构图类似如下：

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/06a7d75bf790478ba390b9036bedf6ab?from=pc)

#### SOA架构分层

SOA架构分层重点就是要体现出独立的服务层，这里可以单独画出具体提供哪些业务服务能力，技术服务能力

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/a19870113dbb4191bc05ed6c0a709850?from=pc)

在图中的服务层已经可以看到一个个独立的API服务接口。如果服务接口数据大，一般只会划分到服务域，比如用户中心服务，采购类服务等。在这种方式下构图参考如下:

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/fb68428e9c284339a5ac3c594b138601?from=pc)

在上图中结合了云和SOA两种架构融合在一起，对于上图中的服务层实际可以理解为组件资源层和服务接口层的融合

#### 应用技术架构分层

注意常说的类似 Java 开发里面的三层架构，数据访问层，业务逻辑层，展现层。或者类似领域模型中的领域服务层，应用层，界面接口层分层方法。

这些本质是偏应用技术架构的描述。

技术架构描述的重点不是讲清楚应用有哪些功能，而是要说清楚应用中的每一个功能是如何通过技术分层来实现的。比如你需要先定义数据库结构，开发数据访问接口，然后编写业务规则逻辑，最好实现前端界面展现设计，再将所有分层内容连接起来。

所以应用技术架构更多是应用实现技术层面的内容，而不是去关心应用实现用的底层 IT 基础设施资源。在应用技术架构里面一般不会涉及到底层具体的资源或平台，如果应用技术架构在底层增加了类似 IT 基础设施，存储等内容，就显得不伦不类了。

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/0602796178fe4560a58f68da898aa478?from=pc)

如果本身就是一个技术平台，类似大数据平台，那么我们在整体构图的时候仍然需要考虑先进行分层，再详细说明每层里面的技术内容。

比如对应一个大数据平台，包括了大数据采集，大数据存储，大数据处理，大数据分析和应用，那么这个就是关键的分层，可以基于这个分层再来考虑各层采用的关键技术。

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/ad4d361ac7894bc390ceeee2a41efccb?from=pc)

对于技术栈构图基本也可以参考技术架构构图模式进行。

![软件架构设计分层模型和构图思考](https://p3.toutiaoimg.com/origin/pgc-image/5e67b5cff6464cc9bd9d84689563fbe9?from=pc)

技术架构重点需要回答的就是你在进行软件架构设计过程中，究竟会用到哪些关键技术，哪些开源产品或工具等。可以细化到具体的技术产品，也可以仅细化到产品类型

技术架构和软件功能分层架构唯一相同的就是分层，技术架构在各个分层里面都没有具体的业务功能点和实现内容，仅仅是关键技术点说明

#### 应用功能架构

应用功能架构需要的是体现出应用有哪些业务模块，有哪些具体的业务功能点，而不是关心应用实现的技术架构分层等内容。

在应用功能层的描述中可以分具体的业务域再到业务功能逐层展开，如果业务应用本身有一个完整的生命周期或阶段线条，那么还可以按阶段来排列具体的功能模块。而底层一般放具体的基础数据管理，元数据管理等功能模块。

当然在应用功能架构的构图中，有时候还需要体现出当前应用和外部应用之间的集成，因此可以在纵向再单独增加了一个接口集成的模块。如下：

![img](https://pic1.zhimg.com/v2-58529cabd2b5c0426f0c7e85ad3bd8ad_r.jpg?source=1940ef5c)

#### 部署架构 - 物理架构还是逻辑架构

常见的网络布线和拓扑架构图

![img](https://pic3.zhimg.com/v2-f60723e9fc4319013b732fb6221f88a0_r.jpg?source=1940ef5c)

这个图体现了 IT 基础设施架构的一个关键内容，即应用层，接入层，汇聚层。汇聚后统一进入到[核心网](https://www.zhihu.com/search?q=核心网&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"answer"%2C"sourceId"%3A2144817478})。核心网通过 DMZ 区再连接到互联网。

如果你做一个 IT 系统的部署架构，一般不会体现最终的应用层内容。

而是体现你核心系统里面的各个 IT 基础设施情况，如数据库服务器，中间件服务器，缓存服务器等。但是所有的资源配置最终仍然是经过汇聚层交换机后进入到核心网。

例如如下：

![img](https://pic1.zhimg.com/v2-ac66164bfa167273908fe2c36020b60b_r.jpg?source=1940ef5c)

因此在部署架构中不会去体现云平台的分层架构，也不会去体现应用分层架构，只需要列清楚具体的物理资源或逻辑资源，以及资源本身接入和汇聚的情况即可。

#### 中台架构

最近几年谈中台和微服务比较多，注意中台本身是一个业务概念。

实际中台层本身是原来应用层可共享的共性业务能力的下沉，中台层能力在原来是属于应用层能力的。因此在中台架构下，应用层进一步拆分为前台应用和中台能力。

![img](https://pic2.zhimg.com/v2-795ce06adf3ec208db03f67d8d942a0b_r.jpg?source=1940ef5c)

领域架构

## 五、架构设计实例

架构图构图案例参考如下：

![img](https://pic2.zhimg.com/v2-c9a9e526e0e2356b3a48d0dd06476801_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-b3e6d97bb8ba393523e6f99ce6a86b25_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-7bad500e8ac707d33c62ab8bd6b5cefc_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-fbf57e517e87d01a67cc6c50b0d42376_r.jpg?source=1940ef5c)

![img](https://pic2.zhimg.com/v2-623a020c3db9df324c55e3f8b066cd8c_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-a486a33a46861785aacb1b49750c7e55_r.jpg?source=1940ef5c)

![img](https://pic2.zhimg.com/v2-6076bce195d26faa7ca5ad31805e195a_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-baf95701cebc6436c59010a0f8f99f51_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-286841eb552d0e4c4cb1962ae89fa1f1_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-a0e21dc4fa0556d96f3b210d22baa23e_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-d8a9b0890604a62ff12894b90b1a7de4_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-fa90d972e41eaf7b101444b3862e375b_r.jpg?source=1940ef5c)

![img](https://pic2.zhimg.com/v2-bbcc7d055c63865af85b53f8bbfad292_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-36bc835528341e73533685e6e1874e4f_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-6bd0092fb9d39b3b097dd5dd02bf19fa_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-6071c5bf783cfef95a7343c3e5ae4e9d_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-664deba7fbfd06f8059670e54489e980_r.jpg?source=1940ef5c)

![img](https://pic2.zhimg.com/v2-69bcdf4608214bc9f9eae2f77d4ac4cb_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-939ec36e594e5fcbceed8c78f480ff5f_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-b071939b420864bc10d1b8212c9a1849_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-7dc79c4f05239c08baa493bc3f381d04_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-be13677397e3e13a38397eb69dcc0a8f_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-4cf06276b7bf9ee846b87bef36c31623_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-95113cf082fcb2c3e1ed194308a93498_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-c2399643c0d256f708e6b8b402425b1e_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-8fa5eb9899cf8f3413b31d2cf25f1dbc_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-cd6227060eabbd0f42381941bfe17b6e_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-3fd37fd36562b3dd201055af81a20a21_r.jpg?source=1940ef5c)

![img](https://pic3.zhimg.com/v2-74ed5546f1f605cf6b19a52ad7d27729_r.jpg?source=1940ef5c)

![img](https://pica.zhimg.com/v2-aba1959025688217669640df3882f98d_r.jpg?source=1940ef5c)

![img](https://pic1.zhimg.com/v2-9ce92180c4d7083b37140ed4eb7098b0_r.jpg?source=1940ef5c)

## 六、架构设计工具

现在常用的设计工具：Visio、ProcessOn 、draw.io

ProcessOn:https://www.processon.com/diagrams  收费

draw.io: www.draw.io   免费

### draw.io

使用技巧希望大家多操作，多使用

可以vscode中一个插件、可以在线及作为独立应用使用

## 七、回顾

架构设计一定不是你懂搭建某个技术框架，这不能叫架构。

真正的架构是你面对业务场景和问题领域的时候采用最佳技术方案去解决问题的能力。

要做到这点。

- **其一是要熟悉你所在的业务场景和业务流程。**
- **其二是能够将技术能力匹配到业务上。**

总结为一句话就是模式应用能力，即当你面对不同的业务场景和问题域的时候，应该采用什么最合适的技术来解决。你需要的是这种匹配能力。

真正的实践过程就是不断地去提炼这种可复用的匹配能力。

架构师靠的是思想，看的是业务拆分，优化结构的能力，这需要大量的阅历以及实战经验，这是一种思维方式的转变，把复杂的事情简单化，把杂乱的逻辑有序化，来达到系统稳定运营的目的，如果一直停留在码代码的阶段，永远不要想成为架构师